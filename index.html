<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editorial Assistant</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="header-title">
                    <h1>Editorial Assistant</h1>
                    <span class="header-subtitle">AI-Powered Content Proofreading</span>
                </div>
            </div>
            <div class="header-center">
                <img src="idBlCGqMMX_1765824035227.jpeg" alt="Educative Logo" class="header-logo">
            </div>
            <div class="header-right">
                <button class="theme-toggle" id="apiKeyBtn" style="margin-right: 10px;">
                    <span>üîë</span>
                    <span>API Key</span>
                </button>
                <button class="theme-toggle" id="themeToggle">
                    <span id="themeIcon">üåô</span>
                    <span id="themeText">Dark Mode</span>
                </button>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" data-tab="text-editor">
                <span>üìù</span>
                <span>Text Editor</span>
            </button>
            <button class="tab-button" data-tab="file-processor">
                <span>üìÑ</span>
                <span>File Processor</span>
            </button>
        </div>

        <div class="content-wrapper">
            <!-- Status Bar (Moved to top) -->
            <div class="status-bar" style="margin-bottom: 24px;">
                <span class="status-text" id="statusText">Ready</span>
                <span class="status-text" id="statusInfo"></span>
            </div>

            <!-- Tab Content Container -->
            <div class="tab-content active" id="text-editor-tab">

            <!-- Toolbar (Card Type + Actions) -->
            <div class="toolbar">
                <!-- Card Type Selector -->
                <div class="card-type-section">
                    <label for="cardType">Card Type:</label>
                    <select id="cardType" class="card-type-dropdown">
                        <option value="none">No limit</option>
                        <option value="text-only">Text-only (390 chars)</option>
                        <option value="text-image">Text+image (250 chars)</option>
                        <option value="highlight">Highlight card (150 chars)</option>
                        <option value="compare">Compare-cards (330 chars)</option>
                        <option value="true-false">True-false (180 chars)</option>
                    </select>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="btn btn-success btn-large" id="grammarBtn">
                        <span id="grammarBtnText">‚úì Quick Spell Check (Free)</span>
                    </button>
                    <button class="btn btn-primary btn-large" id="proofreadBtn" disabled>
                        <span id="proofreadBtnText">‚ú® Proofread</span>
                    </button>
                    <button class="btn btn-warning btn-large" id="trimBtn" disabled style="display: none;">
                        <span id="trimBtnText">‚úÇÔ∏è Trim Text</span>
                    </button>
                    <button class="btn btn-secondary btn-large" id="copyBtn" disabled>
                        üìã Copy
                    </button>
                    <button class="btn btn-secondary btn-large" id="diffBtn" disabled>
                        üîÑ Diff
                    </button>
                </div>
            </div>

            <div style="height: 24px;"></div>

            <!-- Main Content Area -->
            <div class="content-area">
                <!-- Input Panel -->
                <div class="panel">
                    <h2>Input Text</h2>

                    <!-- Grammar Hint Banner -->
                    <div class="grammar-hint-banner" id="grammarHintBanner">
                        <div class="grammar-hint-text">
                            <span>üí°</span>
                            <div>
                                <div><strong id="issueCount">0 issues</strong> found. Click underlined words to fix them, or press <kbd>Esc</kbd> to dismiss.</div>
                                <div class="grammar-legend">
                                    <span class="legend-item"><span class="legend-dot spell"></span>Spelling</span>
                                    <span class="legend-item"><span class="legend-dot grammar"></span>Grammar</span>
                                    <span class="legend-item"><span class="legend-dot style"></span>Style</span>
                                </div>
                            </div>
                        </div>
                        <div class="grammar-hint-actions">
                            <button class="grammar-hint-accept-all" id="acceptAllBtn">‚úì Accept All</button>
                            <button class="grammar-hint-dismiss" id="dismissHints">‚úï Clear</button>
                        </div>
                    </div>

                    <div class="textarea-container">
                        <div class="grammar-highlight-container">
                            <div class="grammar-highlights" id="grammarHighlights"></div>
                            <textarea id="inputText" placeholder="Paste your course or lesson text here..."></textarea>
                        </div>
                        <div class="char-count" id="charCount">0 characters</div>
                    </div>

                    <!-- Grammar Issues Panel -->
                    <div id="grammarPanel" class="grammar-panel" style="display: none;">
                        <div class="grammar-header">
                            <h3>Grammar Issues</h3>
                            <span class="grammar-badge" id="grammarCount">0 issues</span>
                        </div>
                        <div id="grammarList" class="grammar-list"></div>
                    </div>
                </div>

                <!-- Output Panel -->
                <div class="panel">
                    <h2>Edited Text</h2>
                    <div class="textarea-container">
                        <textarea id="outputText" placeholder="Edited text will appear here..." readonly></textarea>
                        <div class="char-count">
                            <span id="outputCharCount">0 characters</span>
                            <span id="charLimitInfo" class="char-limit-info"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Diff Viewer -->
            <div class="diff-container" id="diffContainer">
                <h2>Changes (Input ‚Üí Output)</h2>
                <div class="diff-content" id="diffContent"></div>
            </div>

            <!-- Copy Confirmation Toast -->
            <div class="copy-confirmation" id="copyConfirmation">
                ‚úì Copied to clipboard!
            </div>

            <!-- Grammar Popup Card -->
            <div class="grammar-popup" id="grammarPopup">
                <div class="grammar-popup-header">
                    <span class="grammar-popup-title" id="grammarPopupTitle">Grammar Issue</span>
                    <button class="grammar-popup-close" id="grammarPopupClose">√ó</button>
                </div>
                <div class="grammar-popup-message" id="grammarPopupMessage"></div>

                <!-- Multiple Suggestions (Harper-style pills) -->
                <div class="grammar-suggestions" id="grammarSuggestions"></div>

                <div class="grammar-popup-actions">
                    <button class="grammar-popup-fix" id="grammarPopupFix"></button>
                    <button class="grammar-popup-dismiss" id="grammarPopupDismiss">Dismiss</button>
                </div>
                <div class="grammar-popup-tip" id="grammarPopupTip" style="display: none;">
                    <span class="grammar-popup-tip-icon">üí°</span>
                    <span id="grammarPopupTipText"></span>
                </div>
            </div>

            </div><!-- End Text Editor Tab -->

            <!-- File Processor Tab -->
            <div class="tab-content" id="file-processor-tab">
                <div class="file-processor-container">
                    <div class="file-upload-section">
                        <h2>üìÅ Upload Document</h2>
                        <div class="file-drop-zone" id="fileDropZone">
                            <div class="file-drop-content">
                                <span class="file-drop-icon">üì§</span>
                                <p class="file-drop-text">Drag & drop your file here</p>
                                <p class="file-drop-subtext">or click to browse</p>
                                <input type="file" id="fileInput" accept=".txt,.md,.doc,.docx" hidden>
                                <button class="btn btn-primary" id="browseFileBtn">Choose File</button>
                            </div>
                            <div class="file-formats">
                                <span class="format-badge">TXT</span>
                                <span class="format-badge">MD</span>
                                <span class="format-badge">DOC</span>
                                <span class="format-badge">DOCX</span>
                            </div>
                        </div>

                        <!-- File Info Display -->
                        <div class="file-info" id="fileInfo" style="display: none;">
                            <div class="file-info-content">
                                <span class="file-icon">üìÑ</span>
                                <div class="file-details">
                                    <span class="file-name" id="fileName"></span>
                                    <span class="file-size" id="fileSize"></span>
                                </div>
                                <button class="btn btn-secondary" id="removeFileBtn">‚úï Remove</button>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="file-actions">
                            <button class="btn btn-primary btn-large" id="proofreadFileBtn" disabled>
                                <span id="proofreadFileBtnText">‚ú® Proofread & Convert to Markdown</span>
                            </button>
                            <button class="btn btn-secondary btn-large" id="fileDiffBtn" disabled style="display: none;">
                                üîÑ View Diff
                            </button>
                            <button class="btn btn-success btn-large" id="downloadMarkdownBtn" disabled style="display: none;">
                                <span>‚¨áÔ∏è Download Markdown</span>
                            </button>
                        </div>
                    </div>

                    <!-- Preview Section -->
                    <div class="file-preview-section">
                        <h2>üìã Markdown Output</h2>

                        <!-- Progress Bar (inline, sleek) -->
                        <div class="file-progress-inline" id="fileProgressInline" style="display: none;">
                            <div class="file-progress-status" id="fileProgressStatus">Reading file...</div>
                            <div class="file-progress-bar-inline">
                                <div class="file-progress-fill-inline" id="fileProgressFillInline"></div>
                            </div>
                        </div>

                        <div class="file-preview" id="markdownPreview">
                            <div class="file-preview-placeholder">
                                <span class="preview-icon">üìù</span>
                                <p>Upload a file and click "Proofread" to see the markdown output here</p>
                            </div>
                        </div>
                    </div>

                    <!-- File Diff Viewer -->
                    <div class="diff-container" id="fileDiffContainer">
                        <h2>Changes (Original ‚Üí Proofread)</h2>
                        <div class="diff-content" id="fileDiffContent"></div>
                    </div>
                </div>
            </div><!-- End File Processor Tab -->

        </div>
    </div>

    <!-- API Key Modal -->
    <div class="modal-overlay hidden" id="apiKeyModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Gemini API Key</h2>
                <button class="close-modal" id="closeApiKeyModal">√ó</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 16px; color: var(--text-secondary);">
                    Enter your Google Gemini API key to enable proofreading. The key is stored locally in your browser.
                </p>
                <div class="api-key-controls" style="flex-direction: column; align-items: stretch;">
                    <input type="password" id="apiKeyInput" class="api-key-input"
                        placeholder="Enter your Gemini API key" style="margin-bottom: 16px;">
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button class="btn btn-secondary" id="clearKeyBtn">Clear Key</button>
                        <button class="btn btn-primary" id="saveKeyBtn">Save & Close</button>
                    </div>
                    <span class="key-status hidden" id="keyStatus" style="margin-top: 10px; justify-content: center;">‚úì
                        Key saved</span>
                </div>
                <p class="security-note" style="text-align: center;">
                    Your API key is sent directly to Google's servers.
                </p>
            </div>
        </div>
    </div>

    <!-- Mammoth.js for DOC/DOCX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>

    <script src="script.js"></script>
</body>

</html>